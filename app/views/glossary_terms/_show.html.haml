= render 'shared/term_alerts', language: language, term: item

.row-fluid
  .col-sm-6.col-xs-12
    - if !request.xhr? && current_user && current_user.manager_or_editor?(item.language_id)
      = link_to edit_language_glossary_term_path(language, item), class: 'pull-left btn btn-primary btn-xs', id: :edit_term_button, remote: true, title: "Edit term" do
        %i.fa.fa-edit
        Edit
      = link_to 'javascript:void(0);', {class: 'pull-left btn btn-default btn-xs', id: :cancel_term_button, style: 'display: none;'} do
        %i.fa.fa-times
        Cancel

      = render 'shared/changes_url', url: changes_language_glossary_term_path(language, item)

    %h4{style: 'margin-top: 2px;'} &nbsp;  TERM DETAILS

    #term-container.clearfix
      = render 'term', language: language, item: item

  .col-sm-6.col-xs-12
    - unless language.is_base_language?
      - translation = item.glossary_term_translations.by_language(language.id).first
      - translation ||= GlossaryTermTranslation.new_with_defaults

      - if !translation.new_record? && !request.xhr? && current_user && current_user.manager_or_editor?(language.id)
        - url = translation.new_record? ? new_language_glossary_term_glossary_term_translation_path(language, item) : edit_language_glossary_term_glossary_term_translation_path(language, item, translation)
        = link_to url, class: 'pull-left btn btn-primary btn-xs', id: :edit_term_translation_button, remote: true, title: "Edit translation" do
          %i.fa.fa-edit
          Edit
        = link_to 'javascript:void(0);', {class: 'pull-left btn btn-default btn-xs', id: :cancel_term_translation_button, style: 'display: none;'} do
          %i.fa.fa-times
          Cancel

        = render 'shared/changes_url', url: changes_language_glossary_term_glossary_term_translation_path(language, item, translation)

      %h4{style: 'margin-top: 2px;'} &nbsp; TRANSLATION (#{language.full_name})

      #term-translation-container.clearfix
        -if translation.new_record?
          - if current_user && current_user.manager_or_editor?(language.id)
            = render 'glossary_term_translations/form', language: language, glossary_term: item, glossary_term_translation: translation
          - else
            .col-xs-12
              Term not yet translated.
              %br/
              If you'd like to propose translation, please use Comments section below.
        - else
          = render 'translation', language: language, item: item, translation: translation

    - unless item.is_private?
      - translations = item.glossary_term_translations.except_language(language.id).includes([:language]).sort{|x,y| x.language.iso_code <=> y.language.iso_code}
      - unless translations.empty?
        %h5= language.is_base_language? ? 'TRANSLATIONS' : 'OTHER TRANSLATIONS'
        %table.table.table-striped.table-bordered
          %tbody
            - translations.each do |translation|
              %tr
                %th= truncate(translation.language.english_name, length: 25)
                %td= link_to translation.term, language_glossary_term_path(translation.language_id, item), remote: request.xhr?
